{"remainingRequest":"/Users/pstaab/code/standards-grading/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/pstaab/code/standards-grading/src/views/instructor-views/AddNewUser.vue?vue&type=script&lang=ts&","dependencies":[{"path":"/Users/pstaab/code/standards-grading/src/views/instructor-views/AddNewUser.vue","mtime":1592133706080},{"path":"/Users/pstaab/code/standards-grading/node_modules/cache-loader/dist/cjs.js","mtime":1588951537868},{"path":"/Users/pstaab/code/standards-grading/node_modules/babel-loader/lib/index.js","mtime":1588951537846},{"path":"/Users/pstaab/code/standards-grading/node_modules/ts-loader/index.js","mtime":1588951543530},{"path":"/Users/pstaab/code/standards-grading/node_modules/cache-loader/dist/cjs.js","mtime":1588951537868},{"path":"/Users/pstaab/code/standards-grading/node_modules/vue-loader/lib/index.js","mtime":1588951550037}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CmltcG9ydCB7CiAgQ29tcG9uZW50LCBWdWUsCn0gZnJvbSAidnVlLXByb3BlcnR5LWRlY29yYXRvciI7CgppbXBvcnQgeyBhcHBfc3RhdGVfc3RvcmUsIHVzZXJfc3RvcmUsIGNvdXJzZV9zdG9yZSB9IGZyb20gIkAvc3RvcmUiOwppbXBvcnQgeyBuZXdDb3Vyc2VVc2VyIH0gZnJvbSAiQC9jb21tb24iOwppbXBvcnQgeyBDb3Vyc2UsIFVzZXIgfSBmcm9tICIuLi8uLi9zdG9yZS9tb2RlbHMiOwoKLy8gQENvbXBvbmVudCh7IG5hbWU6ICJBZGROZXdVc2VyIiB9KQpAQ29tcG9uZW50KHt9KQpleHBvcnQgZGVmYXVsdCBjbGFzcyBBZGROZXdVc2VyIGV4dGVuZHMgVnVlIHsKICBwcml2YXRlIG5ld19jb3Vyc2VfdXNlciA9IG5ld0NvdXJzZVVzZXIoKTsKICBwcml2YXRlIHNob3dfdXNlcl9pbmZvID0gZmFsc2U7CiAgcHJpdmF0ZSBuZXdfY291cnNlX3VzZXJfdGFiX2luZGV4ID0gMDsKICBwcml2YXRlIG9rX2Rpc2FibGVkID0gdHJ1ZTsKCiAgcHJpdmF0ZSBnZXQgbG9naW5fbmFtZXMoKSB7CiAgICByZXR1cm4gdXNlcl9zdG9yZS51c2Vycy5tYXAoKF91c2VyOiBVc2VyKSA9PiBfdXNlci5sb2dpbl9uYW1lKTsKICB9CgogIHByaXZhdGUgZ2V0IHVzZXJfZXhpc3RzKCkgewogICAgcmV0dXJuIHRoaXMubG9naW5fbmFtZXMuaW5jbHVkZXModGhpcy5uZXdfY291cnNlX3VzZXIubG9naW5fbmFtZSk7CiAgfQoKICBwcml2YXRlIGdldCBva190aXRsZSgpIHsKICAgIHJldHVybiB0aGlzLnVzZXJfZXhpc3RzID8gIkFkZCBVc2VyIHRvIENvdXJzZSIgOiAiQ3JlYXRlIE5ldyBVc2VyIGFuZCBBZGQgVG8gQ291cnNlIjsKICB9CgogIHByaXZhdGUgZ2V0IGNvdXJzZV9uYW1lKCkgewogICAgY29uc3QgY291cnNlID0gY291cnNlX3N0b3JlLmNvdXJzZXMKICAgICAgLmZpbmQoKF9jb3Vyc2U6IENvdXJzZSkgPT4gX2NvdXJzZS5jb3Vyc2VfaWQgPT09IGFwcF9zdGF0ZV9zdG9yZS5jdXJyZW50X2NvdXJzZV9pZCk7CiAgICByZXR1cm4gY291cnNlID8gY291cnNlLmNvdXJzZV9uYW1lIDogIiI7CiAgfQoKICBwcml2YXRlIGdldCBjb3Vyc2VfdXNlcnMoKSB7CiAgICByZXR1cm4gY291cnNlX3N0b3JlLmNvdXJzZV91c2VyczsKICB9CgogIHByaXZhdGUgc2hvd0luZm8oKSB7CiAgICB0aGlzLnNob3dfdXNlcl9pbmZvID0gdHJ1ZTsKICAgIHNldFRpbWVvdXQoKCkgPT4geyB0aGlzLm5ld19jb3Vyc2VfdXNlcl90YWJfaW5kZXggPSAxOyB9LCA1MCk7IC8vIG5ldyBhIHNsaWdodCBkZWxheSB0byBvcGVuIHRoZSBuZXh0IHRhYi4KICAgIGNvbnN0IHVzZXIgPSB1c2VyX3N0b3JlLnVzZXJzLmZpbmQoKF91c2VyOiBVc2VyKSA9PiBfdXNlci5sb2dpbl9uYW1lID09PSB0aGlzLm5ld19jb3Vyc2VfdXNlci5sb2dpbl9uYW1lKTsKICAgIGlmICh1c2VyKSB7CiAgICAgIHRoaXMubmV3X2NvdXJzZV91c2VyLmZpcnN0X25hbWUgPSB1c2VyLmZpcnN0X25hbWU7CiAgICAgIHRoaXMubmV3X2NvdXJzZV91c2VyLmxhc3RfbmFtZSA9IHVzZXIubGFzdF9uYW1lOwogICAgICB0aGlzLm5ld19jb3Vyc2VfdXNlci5lbWFpbCA9IHVzZXIuZW1haWw7CiAgICAgIHRoaXMubmV3X2NvdXJzZV91c2VyLnVzZXJfaWQgPSB1c2VyLnVzZXJfaWQ7CiAgICAgIHRoaXMubmV3X2NvdXJzZV91c2VyLmNvdXJzZV9pZCA9IGFwcF9zdGF0ZV9zdG9yZS5jdXJyZW50X2NvdXJzZV9pZDsKICAgIH0KICAgIHRoaXMub2tfZGlzYWJsZWQgPSBmYWxzZTsKICB9CgogIHByaXZhdGUgYXN5bmMgc2F2ZVVzZXIoKSB7CiAgICBpZiAodGhpcy5uZXdfY291cnNlX3VzZXIudXNlcl9pZCA+IDApIHsKICAgICAgYXdhaXQgY291cnNlX3N0b3JlLnVwZGF0ZUNvdXJzZVVzZXIodGhpcy5uZXdfY291cnNlX3VzZXIpOwogICAgfSBlbHNlIHsKICAgICAgY29uc3QgbmV3X3VzZXIgPSBhd2FpdCB1c2VyX3N0b3JlLmFkZFVzZXIodGhpcy5uZXdfY291cnNlX3VzZXIpOwogICAgICBPYmplY3QuYXNzaWduKHRoaXMubmV3X2NvdXJzZV91c2VyLCBuZXdfdXNlciwgeyBjb3Vyc2VfaWQ6IGFwcF9zdGF0ZV9zdG9yZS5jdXJyZW50X2NvdXJzZV9pZCB9KTsKICAgICAgY29uc29sZS5sb2codGhpcy5uZXdfY291cnNlX3VzZXIpOyAvLyBlc2xpbnQtZGlzYWJsZS1saW5lIG5vLWNvbnNvbGUKICAgICAgYXdhaXQgY291cnNlX3N0b3JlLnVwZGF0ZUNvdXJzZVVzZXIodGhpcy5uZXdfY291cnNlX3VzZXIpOwogICAgfQogICAgdGhpcy5uZXdfY291cnNlX3VzZXIgPSBuZXdDb3Vyc2VVc2VyKCk7CiAgfQp9Cg=="},{"version":3,"sources":["AddNewUser.vue"],"names":[],"mappings":";AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"AddNewUser.vue","sourceRoot":"src/views/instructor-views","sourcesContent":["<script lang=\"ts\">\nimport {\n  Component, Vue,\n} from \"vue-property-decorator\";\n\nimport { app_state_store, user_store, course_store } from \"@/store\";\nimport { newCourseUser } from \"@/common\";\nimport { Course, User } from \"../../store/models\";\n\n// @Component({ name: \"AddNewUser\" })\n@Component({})\nexport default class AddNewUser extends Vue {\n  private new_course_user = newCourseUser();\n  private show_user_info = false;\n  private new_course_user_tab_index = 0;\n  private ok_disabled = true;\n\n  private get login_names() {\n    return user_store.users.map((_user: User) => _user.login_name);\n  }\n\n  private get user_exists() {\n    return this.login_names.includes(this.new_course_user.login_name);\n  }\n\n  private get ok_title() {\n    return this.user_exists ? \"Add User to Course\" : \"Create New User and Add To Course\";\n  }\n\n  private get course_name() {\n    const course = course_store.courses\n      .find((_course: Course) => _course.course_id === app_state_store.current_course_id);\n    return course ? course.course_name : \"\";\n  }\n\n  private get course_users() {\n    return course_store.course_users;\n  }\n\n  private showInfo() {\n    this.show_user_info = true;\n    setTimeout(() => { this.new_course_user_tab_index = 1; }, 50); // new a slight delay to open the next tab.\n    const user = user_store.users.find((_user: User) => _user.login_name === this.new_course_user.login_name);\n    if (user) {\n      this.new_course_user.first_name = user.first_name;\n      this.new_course_user.last_name = user.last_name;\n      this.new_course_user.email = user.email;\n      this.new_course_user.user_id = user.user_id;\n      this.new_course_user.course_id = app_state_store.current_course_id;\n    }\n    this.ok_disabled = false;\n  }\n\n  private async saveUser() {\n    if (this.new_course_user.user_id > 0) {\n      await course_store.updateCourseUser(this.new_course_user);\n    } else {\n      const new_user = await user_store.addUser(this.new_course_user);\n      Object.assign(this.new_course_user, new_user, { course_id: app_state_store.current_course_id });\n      console.log(this.new_course_user); // eslint-disable-line no-console\n      await course_store.updateCourseUser(this.new_course_user);\n    }\n    this.new_course_user = newCourseUser();\n  }\n}\n</script>\n\n<template>\n  <b-modal\n  id=\"add-new-user-modal\"\n  title=\"Add New User\"\n  :ok-title=\"ok_title\"\n  :ok-disabled=\"ok_disabled\"\n  @ok=\"saveUser\"\n  >\n    <b-card no-body>\n      <b-tabs card v-model=\"new_course_user_tab_index\">\n        <b-tab title=\"Login Name\">\n          <b-card-text>\n            <b-form-group\n              label=\"Login Name\"\n              label-cols=\"6\"\n            >\n              <b-input size=\"sm\" v-model=\"new_course_user.login_name\"/>\n            </b-form-group>\n          </b-card-text>\n          <b-card-text>\n          <b-form-group\n            label=\"User Role\"\n            label-cols=\"6\"\n          >\n            <b-select size=\"sm\" v-model=\"new_course_user.role\">\n              <option value=\"student\">Student</option>\n              <option value=\"instructor\">Instructor</option>\n            </b-select>\n          </b-form-group>\n        </b-card-text>\n\n        <b-card-text v-if=\"user_exists\">\n          <span class=\"text-info pr-3\">This user exists.</span>\n        </b-card-text>\n\n        <b-card-text v-if=\"new_course_user.login_name.length > 0 \">\n          <b-btn size=\"sm\"\n            @click=\"showInfo\"\n            variant=\"outline-dark\"\n            >Add info for user: {{new_course_user.login_name}}\n          </b-btn>\n        </b-card-text>\n      </b-tab>\n      <b-tab title=\"User Info\" :disabled=\"!show_user_info\">\n        <b-card-text>\n          <b-form-group label=\"First Name\" label-cols=\"6\">\n            <b-input v-model=\"new_course_user.first_name\" :disabled=\"user_exists\" />\n          </b-form-group>\n          <b-form-group label=\"Last Name\" label-cols=\"6\">\n            <b-input v-model=\"new_course_user.last_name\" :disabled=\"user_exists\" />\n          </b-form-group>\n          <b-form-group label=\"Email\" label-cols=\"6\">\n            <b-input v-model=\"new_course_user.email\" type=\"email\" :disabled=\"user_exists\"/>\n          </b-form-group>\n        </b-card-text>\n      </b-tab>\n    </b-tabs>\n  </b-card>\n</b-modal>\n</template>\n"]}]}